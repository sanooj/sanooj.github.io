const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/StoryViewerLoader-CJoNIH4W.js","assets/index-De5f6n9C.js","assets/index-11BEJxOj.css","assets/StoryViewerLoader-Co5WXu8l.css","assets/StoryViewerProfile-A3YoPtyT.js","assets/StoryViewerProfile-CMOpGzFn.css"])))=>i.map(i=>d[i]);
import{a as j,r as u,u as E,j as r,_ as v}from"./index-De5f6n9C.js";import{a as N}from"./api-AjEM0RAc.js";const V="_storyViewer_5xii1_1",f="_header_5xii1_5",w="_storyContent_5xii1_17",g="_previous_5xii1_42",I="_current_5xii1_45",S="_next_5xii1_82",l={storyViewer:V,header:f,storyContent:w,previous:g,current:I,next:S},P=a=>{const{id:t}=j(),[e,d]=u.useState(),[i,c]=u.useState(0),x=E(),o=s=>{var n,p;switch((n=a==null?void 0:a.current)==null||n.classList.remove("animation-in"),s){case"NEXT":if(e!=null&&e.stories&&((p=e==null?void 0:e.stories)==null?void 0:p.length)-1===i){m();return}c(_=>_+1);break;case"PREV":if(i===0)return;c(_=>_-1);break;default:c(0);break}};u.useEffect(()=>{if(!(e!=null&&e.stories[i].duration))return;const s=setTimeout(()=>{if((e==null?void 0:e.stories.length)-1===i){m();return}o("NEXT")},(e==null?void 0:e.stories[i].duration)*1e3);return()=>clearInterval(s)},[e,i]);const m=async()=>{var n;if(!(e!=null&&e.nextUserId))return;const s=await h(e==null?void 0:e.nextUserId);s&&(x(`/stories/${s==null?void 0:s.username}/${s==null?void 0:s.userId}`),(n=a==null?void 0:a.current)==null||n.classList.add("animation-in"),c(0))},h=async s=>{if(!s)return;const n=await N(s);return d(n),n};return u.useEffect(()=>{t&&h(t)},[t]),{story:e,switchStory:o,currentIndex:i}},T=u.lazy(()=>v(()=>import("./StoryViewerLoader-CJoNIH4W.js"),__vite__mapDeps([0,1,2,3]))),b=u.lazy(()=>v(()=>import("./StoryViewerProfile-A3YoPtyT.js"),__vite__mapDeps([4,1,2,5]))),z=()=>{var i;const a=u.useRef(null),{story:t,switchStory:e,currentIndex:d}=P(a);return r.jsxs("div",{className:l.storyViewer,children:[r.jsxs("header",{className:l.header,children:[r.jsx(T,{stories:t==null?void 0:t.stories,currentIndex:d}),r.jsx(b,{story:t})]}),r.jsxs("div",{className:l.storyContent,ref:a,children:[r.jsx("a",{onClick:()=>e("PREV"),"data-cy":"prev-button",children:r.jsx("span",{className:"hidden",children:"prev"})}),(i=t==null?void 0:t.stories)==null?void 0:i.map(({storyId:c,imageUrl:x},o)=>r.jsx(r.Fragment,{children:(d-1==o||d===o)&&r.jsx("img",{src:x,alt:c,"data-cy":"story","data-index":o,loading:"lazy",className:d-1===o?l.previous:l.current},c)})),r.jsx("a",{className:l.next,onClick:()=>e("NEXT"),"data-cy":"next-button",children:r.jsx("span",{className:"hidden",children:"Next"})})]})]})};export{z as default};
