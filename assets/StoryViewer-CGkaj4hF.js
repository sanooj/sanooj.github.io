const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/StoryViewerLoader-qybnJDtC.js","assets/index-BrzeiSC9.js","assets/index-11BEJxOj.css","assets/StoryViewerLoader-Co5WXu8l.css","assets/StoryViewerProfile-D7dXAvy_.js","assets/StoryViewerProfile-CMOpGzFn.css"])))=>i.map(i=>d[i]);
import{a as j,r as d,u as E,j as r,_ as v}from"./index-BrzeiSC9.js";import{a as N}from"./api-AjEM0RAc.js";const V="_storyViewer_5xii1_1",f="_header_5xii1_5",w="_storyContent_5xii1_17",g="_previous_5xii1_42",I="_current_5xii1_45",S="_next_5xii1_82",l={storyViewer:V,header:f,storyContent:w,previous:g,current:I,next:S},P=i=>{const{id:t}=j(),[e,o]=d.useState(),[a,u]=d.useState(0),_=E(),n=s=>{var c,p;switch((c=i==null?void 0:i.current)==null||c.classList.remove("animation-in"),s){case"NEXT":if(e!=null&&e.stories&&((p=e==null?void 0:e.stories)==null?void 0:p.length)-1===a){m();return}u(x=>x+1);break;case"PREV":if(a===0)return;u(x=>x-1);break;default:u(0);break}};d.useEffect(()=>{if(!(e!=null&&e.stories[a].duration))return;const s=setTimeout(()=>{if((e==null?void 0:e.stories.length)-1===a){m();return}n("NEXT")},(e==null?void 0:e.stories[a].duration)*1e3);return()=>clearInterval(s)},[e,a]);const m=async()=>{var c;if(!(e!=null&&e.nextUserId))return;const s=await h(e==null?void 0:e.nextUserId);s&&(_(`/stories/${s==null?void 0:s.username}/${s==null?void 0:s.userId}`),(c=i==null?void 0:i.current)==null||c.classList.add("animation-in"),u(0))},h=async s=>{if(!s)return;const c=await N(s);return o(c),c};return d.useEffect(()=>{t&&h(t)},[t]),{story:e,switchStory:n,currentIndex:a}},T=d.lazy(()=>v(()=>import("./StoryViewerLoader-qybnJDtC.js"),__vite__mapDeps([0,1,2,3]))),b=d.lazy(()=>v(()=>import("./StoryViewerProfile-D7dXAvy_.js"),__vite__mapDeps([4,1,2,5]))),z=()=>{var a;const i=d.useRef(null),{story:t,switchStory:e,currentIndex:o}=P(i);return r.jsxs("div",{className:l.storyViewer,children:[r.jsxs("header",{className:l.header,children:[r.jsx(T,{stories:t==null?void 0:t.stories,currentIndex:o}),r.jsx(b,{story:t})]}),r.jsxs("div",{className:l.storyContent,ref:i,children:[r.jsx("a",{onClick:()=>e("PREV"),"data-cy":"prev-button",children:r.jsx("span",{className:"hidden",children:"prev"})}),(a=t==null?void 0:t.stories)==null?void 0:a.map(({storyId:u,imageUrl:_},n)=>r.jsx(r.Fragment,{children:(o-1==n||o===n)&&r.jsx("img",{src:_,alt:u,...o===n?{"data-cy":"story","data-index":n}:{},loading:"lazy",className:o-1===n?l.previous:l.current},u)})),r.jsx("a",{className:l.next,onClick:()=>e("NEXT"),"data-cy":"next-button",children:r.jsx("span",{className:"hidden",children:"Next"})})]})]})};export{z as default};
