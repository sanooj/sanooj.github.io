const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/StoryViewerLoader-0FP4xFbX.js","assets/index-CBR2hY-_.js","assets/index-9F-ezif6.css","assets/StoryViewerLoader-Co5WXu8l.css","assets/StoryViewerProfile-CnVjUrUI.js","assets/StoryViewerProfile-CMOpGzFn.css"])))=>i.map(i=>d[i]);
import{a as f,r as i,u as p,j as n,_ as m}from"./index-CBR2hY-_.js";import{a as E}from"./api-AjEM0RAc.js";const j="_header_1wk35_1",N="_storyContent_1wk35_13",v="_next_1wk35_36",u={header:j,storyContent:N,next:v},w=()=>{const{id:s}=f(),[e,d]=i.useState(),[r,a]=i.useState(0),l=p(),c=t=>{var o;switch(t){case"NEXT":if(e!=null&&e.stories&&((o=e==null?void 0:e.stories)==null?void 0:o.length)-1===r){_();return}a(x=>x+1);break;case"PREV":if(r===0)return;a(x=>x-1);break;default:a(0);break}};i.useEffect(()=>{if(!(e!=null&&e.stories[r].duration))return;const t=setTimeout(()=>{if((e==null?void 0:e.stories.length)-1===r){_();return}c("NEXT")},(e==null?void 0:e.stories[r].duration)*1e3);return()=>clearInterval(t)},[e,r]);const _=async()=>{if(!(e!=null&&e.nextUserId))return;const t=await h(e==null?void 0:e.nextUserId);t&&(l(`/stories/${t==null?void 0:t.username}/${t==null?void 0:t.userId}`),a(0))},h=async t=>{if(!t)return;const o=await E(t);return d(o),o};return i.useEffect(()=>{s&&h(s)},[s]),{story:e,switchStory:c,currentIndex:r}},V=i.lazy(()=>m(()=>import("./StoryViewerLoader-0FP4xFbX.js"),__vite__mapDeps([0,1,2,3]))),k=i.lazy(()=>m(()=>import("./StoryViewerProfile-CnVjUrUI.js"),__vite__mapDeps([4,1,2,5]))),C=()=>{var r;const{story:s,switchStory:e,currentIndex:d}=w();return n.jsxs("div",{className:u.storyViewer,children:[n.jsxs("header",{className:u.header,children:[n.jsx(V,{stories:s==null?void 0:s.stories,currentIndex:d}),n.jsx(k,{story:s})]}),n.jsxs("div",{className:u.storyContent,children:[n.jsx("a",{onClick:()=>e("PREV"),"data-cy":"prev-button",children:n.jsx("span",{className:"hidden",children:"prev"})}),(r=s==null?void 0:s.stories)==null?void 0:r.map(({storyId:a,imageUrl:l},c)=>d===c&&n.jsx("img",{src:l,alt:a,"data-cy":"story","data-index":c},a)),n.jsx("a",{className:u.next,onClick:()=>e("NEXT"),"data-cy":"next-button",children:n.jsx("span",{className:"hidden",children:"Next"})})]})]})};export{C as default};
